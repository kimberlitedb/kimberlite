{% extends "docs/base_docs.html" %}

{% block docs_content %}
<header class="docs__header">
  <h1 class="docs__title">CLI Reference</h1>
  <p class="docs__subtitle">Complete reference for the <code>kimberlite</code> command-line interface.</p>
</header>

<section class="docs__section">
  <h2 id="overview">Overview</h2>
  <p>The Kimberlite CLI provides commands for initializing, running, and interacting with your database.</p>

  <div class="code-block">
    <div class="code-block__header">
      <div class="code-block__buttons">
        <span class="code-block__button code-block__button--close"></span>
        <span class="code-block__button code-block__button--minimize"></span>
        <span class="code-block__button code-block__button--maximize"></span>
      </div>
      <span class="code-block__label">Terminal</span>
      <span></span>
    </div>
    <pre class="code-block__code"><code><span class="code-block__prompt">$</span> kimberlite --help
<span class="code-block__output">Kimberlite unified CLI - the compliance-first database

Usage: kimberlite &lt;COMMAND&gt;

Commands:
  version  Show version information
  init     Initialize a new data directory
  start    Start the Kimberlite server
  repl     Interactive SQL REPL
  query    Execute a single SQL query
  stream   Stream management commands
  info     Show server information
  help     Print this message or help for subcommands</span></code></pre>
  </div>
</section>

<section class="docs__section">
  <h2 id="init">kimberlite init</h2>
  <p>Initialize a new data directory with required files and structure.</p>

  <div class="docs__command-signature">
    <code>kimberlite init [OPTIONS] &lt;PATH&gt;</code>
  </div>

  <h3>Arguments</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Argument</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>&lt;PATH&gt;</code></td>
        <td>Path to the data directory to create</td>
      </tr>
    </tbody>
  </table>

  <h3>Options</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Option</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>--development</code></td>
        <td>Enable development mode (disables fsync for faster writes)</td>
      </tr>
    </tbody>
  </table>

  <h3>Example</h3>
  <div class="code-block">
    <div class="code-block__header">
      <div class="code-block__buttons">
        <span class="code-block__button code-block__button--close"></span>
        <span class="code-block__button code-block__button--minimize"></span>
        <span class="code-block__button code-block__button--maximize"></span>
      </div>
      <span class="code-block__label">Terminal</span>
      <button class="code-block__copy" data-copy="kimberlite init ./data --development">
        <svg class="code-block__copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
        </svg>
        Copy
      </button>
    </div>
    <pre class="code-block__code"><code><span class="code-block__prompt">$</span> kimberlite init ./data --development</code></pre>
  </div>

  <h3>Created Structure</h3>
  <div class="code-block">
    <div class="code-block__header">
      <div class="code-block__buttons">
        <span class="code-block__button code-block__button--close"></span>
        <span class="code-block__button code-block__button--minimize"></span>
        <span class="code-block__button code-block__button--maximize"></span>
      </div>
      <span class="code-block__label">Directory</span>
      <span></span>
    </div>
    <pre class="code-block__code"><code><span class="code-block__output">./data/
├── config.toml      # Server configuration
├── log/             # Append-only log directory
├── store/           # Storage files
└── projections.db   # B+tree projection store</span></code></pre>
  </div>
</section>

<section class="docs__section">
  <h2 id="start">kimberlite start</h2>
  <p>Start the Kimberlite server daemon.</p>

  <div class="docs__command-signature">
    <code>kimberlite start [OPTIONS] &lt;PATH&gt;</code>
  </div>

  <h3>Arguments</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Argument</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>&lt;PATH&gt;</code></td>
        <td>Path to the data directory</td>
      </tr>
    </tbody>
  </table>

  <h3>Options</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Option</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>-a, --address</code></td>
        <td><code>5432</code></td>
        <td>Address to bind to (port or full address)</td>
      </tr>
      <tr>
        <td><code>--development</code></td>
        <td>-</td>
        <td>Disable replication for development</td>
      </tr>
    </tbody>
  </table>

  <h3>Examples</h3>
  <div class="code-block">
    <div class="code-block__header">
      <div class="code-block__buttons">
        <span class="code-block__button code-block__button--close"></span>
        <span class="code-block__button code-block__button--minimize"></span>
        <span class="code-block__button code-block__button--maximize"></span>
      </div>
      <span class="code-block__label">Terminal</span>
      <span></span>
    </div>
    <pre class="code-block__code"><code><span class="code-block__comment"># Start on default port (5432)</span>
<span class="code-block__prompt">$</span> kimberlite start ./data

<span class="code-block__comment"># Start on custom port</span>
<span class="code-block__prompt">$</span> kimberlite start --address 3000 ./data

<span class="code-block__comment"># Start with full address</span>
<span class="code-block__prompt">$</span> kimberlite start --address 0.0.0.0:3000 ./data</code></pre>
  </div>
</section>

<section class="docs__section">
  <h2 id="repl">kimberlite repl</h2>
  <p>Start an interactive SQL REPL session.</p>

  <div class="docs__command-signature">
    <code>kimberlite repl [OPTIONS]</code>
  </div>

  <h3>Options</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Option</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>-a, --address</code></td>
        <td><code>127.0.0.1:5432</code></td>
        <td>Server address to connect to</td>
      </tr>
      <tr>
        <td><code>-t, --tenant</code></td>
        <td><code>1</code></td>
        <td>Tenant ID</td>
      </tr>
    </tbody>
  </table>

  <h3>REPL Commands</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Command</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>.help</code></td>
        <td>Show help message</td>
      </tr>
      <tr>
        <td><code>.tables</code></td>
        <td>List all tables</td>
      </tr>
      <tr>
        <td><code>.exit</code>, <code>.quit</code></td>
        <td>Exit the REPL</td>
      </tr>
    </tbody>
  </table>
</section>

<section class="docs__section">
  <h2 id="query">kimberlite query</h2>
  <p>Execute a single SQL query.</p>

  <div class="docs__command-signature">
    <code>kimberlite query [OPTIONS] &lt;SQL&gt;</code>
  </div>

  <h3>Arguments</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Argument</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>&lt;SQL&gt;</code></td>
        <td>SQL query string</td>
      </tr>
    </tbody>
  </table>

  <h3>Options</h3>
  <table class="docs__table">
    <thead>
      <tr>
        <th>Option</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>-s, --server</code></td>
        <td><code>127.0.0.1:5432</code></td>
        <td>Server address</td>
      </tr>
      <tr>
        <td><code>-t, --tenant</code></td>
        <td><code>1</code></td>
        <td>Tenant ID</td>
      </tr>
      <tr>
        <td><code>-a, --at</code></td>
        <td>-</td>
        <td>Query at a specific log position (time travel)</td>
      </tr>
    </tbody>
  </table>

  <h3>Examples</h3>
  <div class="code-block">
    <div class="code-block__header">
      <div class="code-block__buttons">
        <span class="code-block__button code-block__button--close"></span>
        <span class="code-block__button code-block__button--minimize"></span>
        <span class="code-block__button code-block__button--maximize"></span>
      </div>
      <span class="code-block__label">Terminal</span>
      <span></span>
    </div>
    <pre class="code-block__code"><code><span class="code-block__comment"># Simple query</span>
<span class="code-block__prompt">$</span> kimberlite query "SELECT * FROM patients"

<span class="code-block__comment"># Time-travel query at position 42</span>
<span class="code-block__prompt">$</span> kimberlite query --at 42 "SELECT * FROM patients"</code></pre>
  </div>
</section>

<section class="docs__section">
  <h2 id="stream">kimberlite stream</h2>
  <p>Manage event streams.</p>

  <h3>stream create</h3>
  <p>Create a new event stream.</p>

  <div class="docs__command-signature">
    <code>kimberlite stream create [OPTIONS] &lt;NAME&gt;</code>
  </div>

  <table class="docs__table">
    <thead>
      <tr>
        <th>Option</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>-c, --class</code></td>
        <td><code>non-phi</code></td>
        <td>Data classification: <code>non-phi</code>, <code>phi</code>, or <code>deidentified</code></td>
      </tr>
    </tbody>
  </table>

  <h3>stream append</h3>
  <p>Append events to a stream.</p>

  <div class="docs__command-signature">
    <code>kimberlite stream append &lt;STREAM_ID&gt; &lt;EVENTS&gt;...</code>
  </div>

  <h3>stream read</h3>
  <p>Read events from a stream.</p>

  <div class="docs__command-signature">
    <code>kimberlite stream read [OPTIONS] &lt;STREAM_ID&gt;</code>
  </div>

  <table class="docs__table">
    <thead>
      <tr>
        <th>Option</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>-f, --from</code></td>
        <td><code>0</code></td>
        <td>Starting offset</td>
      </tr>
      <tr>
        <td><code>-m, --max-bytes</code></td>
        <td><code>65536</code></td>
        <td>Maximum bytes to read</td>
      </tr>
    </tbody>
  </table>
</section>

<section class="docs__section">
  <h2 id="version">kimberlite version</h2>
  <p>Display version and build information.</p>

  <div class="code-block">
    <div class="code-block__header">
      <div class="code-block__buttons">
        <span class="code-block__button code-block__button--close"></span>
        <span class="code-block__button code-block__button--minimize"></span>
        <span class="code-block__button code-block__button--maximize"></span>
      </div>
      <span class="code-block__label">Terminal</span>
      <span></span>
    </div>
    <pre class="code-block__code"><code><span class="code-block__prompt">$</span> kimberlite version
<span class="code-block__output">kimberlite-cli 0.1.0

The compliance-first database for regulated industries.

Build info:
  Rust version: 1.88+
  Target:       aarch64
  OS:           macos</span></code></pre>
  </div>
</section>
{% endblock %}
